{% comment  %}
   Takes lemma list as lemmas and file name as file_name
{% endcomment %}
<?xml version="1.0" encoding="UTF-8"?>
<r xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:hfp="http://www.w3.org/2001/XMLSchema-hasFacetAndProperty" xmlns:fn="http://www.w3.org/2005/02/xpath-functions" xsi:noNamespaceSchemaLocation="../../../../../gtcore/schemas/fiu-dict-schema.xsd" xml:lang="sms">
    {% for element in lemmas %}
    {% for homonym in element.homonyms %}
    {% if (homonym.morph and homonym.morph.file == file_name) or homonym.POS + "_sms2x.xml" == file_name  %}
    <e id="{{ homonym.morph_id }}" meta="{{ homonym.morph.meta }}">
        {% if homonym.morph.map %}
       <map {% for key, value in homonym.morph.map.items %} {{ key }} = "{{ value }}" {% endfor %}/>
        {% endif %}
        {% if homonym.morph.revsortkey %}
       <rev-sort_key>{{ homonym.morph.revsortkey }}</rev-sort_key>
        {% endif %}
       <lg>
         <l pos="{{ homonym.POS }}">{{ element.lemma }}</l>
         {% for key, value in homonym.morph.lg.items %}
           {{value}}
           {% endfor %}
       </lg>
        {% if homonym.sms2xml %}
         <sources>
             {% for source in homonym.sms2xml.sources %}
           <book {%for key, value in source.items %} {{ key }}="{{ value }}" {% endfor %}/>
             {% endfor %}
         </sources>
        {% endif %}
       <mg>
           {% for key, value in homonym.lexicon.items %}
           <lexicon xml:lang="{{ key }}">{{ value }}</lexicon>
           {% endfor %}
         <semantics>
             {% for semantic in homonym.semantics %}
           <sem class="{{ semantic.class }}">{{ semantic.value }}</sem>
             {% endfor %}
         </semantics>
           {% for lang, translations in homonym.translations %}
             <tg xml:lang="{{ lang }}">
                 {% for translation in translations %}
               <t pos="{{translation.POS}}">translation.word</t>
                 {% endfor %}
             </tg>
           {% endfor %}

       </mg>
    </e>
    {% endfor %}
    {% endfor %}
    {% endif %}
</r>