{% comment  %}
   Takes lemma list as lemmas and file name as file_name
{% endcomment %}
<?xml version="1.0" encoding="UTF-8"?>
<r xml:lang="sms">
    {% for element in lemmas %}
    {% for homonym in element.homonyms %}
    {% get_subitem_text homonym "sms2xml.file" as homonym_file_name %}
    {% filename_and_pos_sms homonym.POS file_name as file_pos %}
    {% if homonym_file_name == file_name or file_pos %}
    {% get_item homonym sms2xml_id as e_id %}
   <e id="{{ e_id }}">
      <lg>
          {% get_subitem_dict homonym "sms2xml.lemmas_additional_attributes" as pos_attrs %}
         <l pos="{{ homonym.POS }}" {%for key, value in pos_attrs.items %} {{ key }}="{{ value }}" {% endfor %}>{{ element.lemma }}</l>
      </lg>
         <sources>
             {% get_subitem_dict homonym "sms2xml.sources" as sources %}
             {% for source in source %}
           <book {%for key, value in source.items %} {{ key }}="{{ value }}" {% endfor %}/>
             {% endfor %}
         </sources>
      <mg>
         <semantics>
             {% get_item_list homonym "semantics" as semantics %}
             {% for semantic in semantics %}
           <sem class="{{ semantic.class }}">{{ semantic.value }}</sem>
             {% endfor %}
         </semantics>
           {% for lang, translations in homonym.translations.items %}
             <tg xml:lang="{{ lang }}">
                 {% for translation in translations %}
               <t pos="{{translation.POS}}">{{ translation.word }}</t>
                 {% endfor %}
             </tg>
           {% endfor %}
      </mg>
   </e>
    {% endif %}
    {% endfor %}
    {% endfor %}
 </r>